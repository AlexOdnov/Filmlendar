!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);const n={1:[1,"one","first"],2:[2,"two","second"],3:[3,"three","third"],4:[4,"four","fourth"],5:[5,"five","fifth"],6:[6,"six","sixth"],7:[7,"seven","seventh"],8:[8,"eight","eighth"],9:[9,"nine","ninth"],10:[10,"ten","tenth"],11:[11,"eleven","eleventh"],12:[12,"twelve"],13:[13,"thirteen","thirteenth"],14:[14,"fourteen","fourteenth"],15:[15,"fifteenth"],16:[16,"sixteen"],17:[17,"seventeen","seventeenth"],18:[18,"eighteen","eighteenth"],19:[19,"nineteen","nineteenth"],20:[20,"twenty","twentieth"],21:[21,"twenty one","twenty first"],22:[22,"twenty two"],23:[23,"twenty third"],24:[24,"twenty four"],25:[25,"twenty five"],26:[26,"twenty six"],27:[27],28:[28,"twenty eight"],29:[29,"twenty nine"],30:[30,"thirty","thirtieth"],31:[31]},i=(t,e)=>Math.floor(t+(e+1-t)*Math.random());
/*! Fast Average Color | Â© 2020 Denis Seleznev | MIT License | https://github.com/fast-average-color/fast-average-color */
function s(t,e,r){for(let n=0;n<r.length;n++){const i=r[n];if(t[e]===i[0]&&t[e+1]===i[1]&&t[e+2]===i[2]&&t[e+3]===i[3])return!0}return!1}function o(t,e,r){const n={},i=r.ignoredColor;for(let o=0;o<e;o+=r.step){const e=t[o],r=t[o+1],a=t[o+2],h=t[o+3];if(i&&s(t,o,i))continue;const c=Math.round(e/24)+","+Math.round(r/24)+","+Math.round(a/24);n[c]?n[c]=[n[c][0]+e*h,n[c][1]+r*h,n[c][2]+a*h,n[c][3]+h,n[c][4]+1]:n[c]=[e*h,r*h,a*h,h,1]}const o=Object.keys(n).map(t=>n[t]).sort((t,e)=>{const r=t[4],n=e[4];return r>n?-1:r===n?0:1})[0],a=o[0],h=o[1],c=o[2],l=o[3],d=o[4];return l?[Math.round(a/l),Math.round(h/l),Math.round(c/l),Math.round(l/d)]:r.defaultColor}function a(t,e,r){let n=0,i=0,o=0,a=0,h=0;const c=r.ignoredColor;for(let l=0;l<e;l+=r.step){const e=t[l+3],r=t[l]*e,d=t[l+1]*e,u=t[l+2]*e;c&&s(t,l,c)||(n+=r,i+=d,o+=u,a+=e,h++)}return a?[Math.round(n/a),Math.round(i/a),Math.round(o/a),Math.round(a/h)]:r.defaultColor}function h(t,e,r){let n=0,i=0,o=0,a=0,h=0;const c=r.ignoredColor;for(let l=0;l<e;l+=r.step){const e=t[l],r=t[l+1],d=t[l+2],u=t[l+3];c&&s(t,l,c)||(n+=e*e*u,i+=r*r*u,o+=d*d*u,a+=u,h++)}return a?[Math.round(Math.sqrt(n/a)),Math.round(Math.sqrt(i/a)),Math.round(Math.sqrt(o/a)),Math.round(a/h)]:r.defaultColor}const c="FastAverageColor: ";const l=new class{getColorAsync(t,e){if(!t)return Promise.reject(Error(c+"call .getColorAsync() without resource."));if("string"==typeof t){const r=new Image;return r.crossOrigin="",r.src=t,this._bindImageEvents(r,e)}if(t.complete){const r=this.getColor(t,e);return r.error?Promise.reject(r.error):Promise.resolve(r)}return this._bindImageEvents(t,e)}getColor(t,e){e=e||{};const r=this._getDefaultColor(e);if(!t)return this._outputError(e,"call .getColor(null) without resource."),this.prepareResult(r);const n=this._getOriginalSize(t),i=this._prepareSizeAndPosition(n,e);if(!(i.srcWidth&&i.srcHeight&&i.destWidth&&i.destHeight))return this._outputError(e,`incorrect sizes for resource "${t.src}".`),this.prepareResult(r);if(!this._ctx&&(this._canvas=this._makeCanvas(),this._ctx=this._canvas.getContext&&this._canvas.getContext("2d"),!this._ctx))return this._outputError(e,"Canvas Context 2D is not supported in this browser."),this.prepareResult(r);this._canvas.width=i.destWidth,this._canvas.height=i.destHeight;let s=r;try{this._ctx.clearRect(0,0,i.destWidth,i.destHeight),this._ctx.drawImage(t,i.srcLeft,i.srcTop,i.srcWidth,i.srcHeight,0,0,i.destWidth,i.destHeight);const r=this._ctx.getImageData(0,0,i.destWidth,i.destHeight).data;s=this.getColorFromArray4(r,e)}catch(r){this._outputError(e,`security error (CORS) for resource ${t.src}.\nDetails: https://developer.mozilla.org/en/docs/Web/HTML/CORS_enabled_image`,r)}return this.prepareResult(s)}getColorFromArray4(t,e){e=e||{};const r=t.length,n=this._getDefaultColor(e);if(r<4)return n;const i=r-r%4,s=4*(e.step||1);let l;switch(e.algorithm||"sqrt"){case"simple":l=a;break;case"sqrt":l=h;break;case"dominant":l=o;break;default:throw Error(`${c}${e.algorithm} is unknown algorithm.`)}return l(t,i,{defaultColor:n,ignoredColor:this._prepareIgnoredColor(e.ignoredColor),step:s})}prepareResult(t){const e=t.slice(0,3),r=[].concat(e,t[3]/255),n=this._isDark(t);return{value:t,rgb:"rgb("+e.join(",")+")",rgba:"rgba("+r.join(",")+")",hex:this._arrayToHex(e),hexa:this._arrayToHex(t),isDark:n,isLight:!n}}_prepareIgnoredColor(t){return Array.isArray(t)&&!Array.isArray(t[0])?[[].concat(t)]:t}destroy(){delete this._canvas,delete this._ctx}_getDefaultColor(t){return this._getOption(t,"defaultColor",[0,0,0,0])}_getOption(t,e,r){return void 0===t[e]?r:t[e]}_prepareSizeAndPosition(t,e){const r=this._getOption(e,"left",0),n=this._getOption(e,"top",0),i=this._getOption(e,"width",t.width),s=this._getOption(e,"height",t.height);let o=i,a=s;if("precision"===e.mode)return{srcLeft:r,srcTop:n,srcWidth:i,srcHeight:s,destWidth:o,destHeight:a};let h;return i>s?(h=i/s,o=100,a=Math.round(o/h)):(h=s/i,a=100,o=Math.round(a/h)),(o>i||a>s||o<10||a<10)&&(o=i,a=s),{srcLeft:r,srcTop:n,srcWidth:i,srcHeight:s,destWidth:o,destHeight:a}}_bindImageEvents(t,e){return new Promise((r,n)=>{const i=()=>{a();const i=this.getColor(t,e);i.error?n(i.error):r(i)},s=()=>{a(),n(Error(`${c}Error loading image ${t.src}.`))},o=()=>{a(),n(Error(`${c}Image "${t.src}" loading aborted.`))},a=()=>{t.removeEventListener("load",i),t.removeEventListener("error",s),t.removeEventListener("abort",o)};t.addEventListener("load",i),t.addEventListener("error",s),t.addEventListener("abort",o)})}_getOriginalSize(t){return t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:{width:t.width,height:t.height}}_toHex(t){const e=t.toString(16);return 1===e.length?"0"+e:e}_arrayToHex(t){return"#"+t.map(this._toHex).join("")}_isDark(t){return(299*t[0]+587*t[1]+114*t[2])/1e3<128}_makeCanvas(){return"undefined"==typeof window?new OffscreenCanvas(1,1):document.createElement("canvas")}_outputError(t,e,r){t.silent||(console.error(`${c}${e}`),r&&console.error(r))}};const d=t=>new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),u=t=>new Date(t.getFullYear(),t.getMonth()-1),g=t=>new Date(t.getFullYear(),t.getMonth()+1);(()=>{if(/android/i.test(window.navigator.userAgent)){const t=document.querySelector(".app"),e=document.querySelector("main"),r=()=>{const r=document.documentElement.clientHeight;t.style.height=r+"px",e.style.maxHeight=r+"px"};r(),window.addEventListener("resize",r)}})();const p=new class{constructor(){this.poster=document.querySelector(".poster"),this.title=document.querySelector(".film-title__title"),this.score=document.querySelector(".film-title__score"),this.bg=document.querySelector("main"),this.calendar=document.querySelector(".app__calendar"),this.copyright=document.querySelector(".copyright"),this.update=this.update.bind(this),this.init()}init(){this.poster.addEventListener("click",()=>{this.calendar.classList.toggle("app__calendar--hide"),this.copyright.classList.toggle("copyright--visible")})}async update(t){try{this.poster.style.opacity="0";const{title:e,id:r,score:n,poster:i}=await this.chooseData(t);this.title.textContent=e,this.title.setAttribute("href","https://www.themoviedb.org/movie/"+r),this.score.textContent=10*n+"%",this.poster.setAttribute("src","https://image.tmdb.org/t/p/original"+i),this.poster.onload=function(){this.poster.style.opacity="",this.setGradient(this.poster)}.bind(this)}catch(t){console.warn(t),this.poster.style.opacity=""}}async loadData(t){const e=`https://api.themoviedb.org/3/search/movie?api_key=656a8601ce7376f61fce608015e04095&language=en-US&query=${(t=>n[t][i(0,n[t].length-1)])(t)}&include_adult=false`;try{const t=await fetch(e);return await t.json()}catch(t){console.warn(t)}}async chooseData(t){try{const e=(await this.loadData(t)).results;let r=i(0,e.length-1);if(e[r].poster_path)return{title:e[r].title,id:e[r].id,score:e[r].vote_average,poster:e[r].poster_path};for(const t of e)if(t.poster_path)return{title:t.title,id:t.id,score:t.vote_average,poster:t.poster_path}}catch(t){console.warn(t)}}setGradient(t){const e=t.naturalHeight,r=Math.floor(e/5),n=[];let i=null;for(let e=0;e<5;e++){const s=l.getColor(t,{left:0,top:e*r,height:r});n.push(`${s.rgb} ${100*e/4}%`),5-e==1&&(i=s)}this.bg.style.background=`linear-gradient(to bottom, ${n.join(", ")})`,this.copyright.style.color=i.isDark?"#fff":"#000"}};new class extends class{constructor(t={}){this.settings=Object.assign({calendarSelector:".calendar"},t),this.calendar=document.querySelector(this.settings.calendarSelector),this.calendarGridWrapper=this.calendar.querySelector(".calendar__grid-wrapper"),this.monthName=this.calendar.querySelector(".calendar__cell--month"),this.prevMonthBtn=this.calendar.querySelector(".calendar__cell--prev-month"),this.nextMonthBtn=this.calendar.querySelector(".calendar__cell--next-month"),this.init()}init(){var t;this.currentDate=(t=new Date,new Date(t.setHours(0,0,0,0))),this.visibleDate=this.currentDate,this.renderCurrentMonth(),this.renderPrevMonth(),this.renderNextMonth(),this.setMonthName(this.currentDate),this.prevMonthBtn.addEventListener("click",this.decreaseMonth.bind(this)),this.nextMonthBtn.addEventListener("click",this.increaseMonth.bind(this))}createMonth(t){const e=d(u(t)),r=d(t),n=(t=>Math.abs((7+new Date(t.getFullYear(),t.getMonth(),1).getDay()-1)%7))(t),i=document.createElement("div");i.classList.add("calendar__grid");let s=0;for(let o=0;o<42;o++){const a=document.createElement("div");a.classList.add("calendar__cell"),i.append(a);const h=e-n+o+1;if(h<=e){s++,a.textContent=h,a.classList.add("calendar__cell--disabled");continue}const c=o-s+1;c<=r?(a.textContent=c,new Date(t.getFullYear(),t.getMonth(),c)-this.currentDate||a.classList.add("calendar__cell--active")):(a.textContent=o-s+1-r,a.classList.add("calendar__cell--disabled"))}return i}renderCurrentMonth(){this.currentMonth=this.createMonth(this.currentDate),this.calendarGridWrapper.append(this.currentMonth)}renderPrevMonth(){const t=u(this.visibleDate);this.prevMonth=this.createMonth(t),this.prevMonth.style.transform="translate(-100%, 0)",this.calendarGridWrapper.prepend(this.prevMonth)}renderNextMonth(){const t=g(this.visibleDate);this.nextMonth=this.createMonth(t),this.nextMonth.style.transform="translate(100%, 0)",this.calendarGridWrapper.append(this.nextMonth)}setMonthName(t){const e=(t=>t.toLocaleString(navigator.language,{month:"long"}))(t),r=t.getFullYear();this.monthName.textContent=`${e}, ${r}`}decreaseMonth(){const t=this.nextMonth;setTimeout(()=>{t.remove()},300),this.nextMonth=this.currentMonth,this.nextMonth.style.transform="translate(100%, 0)",this.currentMonth=this.prevMonth,this.currentMonth.style.transform="translate(0, 0)",this.visibleDate=u(this.visibleDate),this.renderPrevMonth(),this.setMonthName(this.visibleDate)}increaseMonth(){const t=this.prevMonth;setTimeout(()=>{t.remove()},300),this.prevMonth=this.currentMonth,this.prevMonth.style.transform="translate(-100%, 0)",this.currentMonth=this.nextMonth,this.currentMonth.style.transform="translate(0, 0)",this.visibleDate=g(this.visibleDate),this.renderNextMonth(),this.setMonthName(this.visibleDate)}}{constructor(t={}){super(t),this.cb=this.settings.cb,this.initImg()}init(){super.init(),this.activeCell=this.calendarGridWrapper.querySelector(".calendar__cell--active"),this.calendarGridWrapper.addEventListener("click",function(t){const e=t.target;e.classList.contains("calendar__cell--disabled")||(this.updateImg(t),this.activeCell.classList.remove("calendar__cell--active"),this.activeCell=e,e.classList.add("calendar__cell--active"))}.bind(this))}initImg(){this.cb(this.currentDate.getDate())}updateImg(t){const e=+t.target.textContent;this.cb(e)}}({cb:p.update})}]);